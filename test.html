<html>
<head>
    <title>Test</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/air-datepicker/dist/css/datepicker.min.css">
    <style>
        .rx-text-input--touched.rx-text-input--invalid input {
            border-color: red;
        }

        .rx-textarea--touched.rx-textarea--invalid textarea {
            border-color: red;
        }

        .rx-success--hidden {
            display: none;
        }

        .rx-success--visible {
            display: block;
        }

        .rx-error--hidden {
            display: none;
        }

        .rx-error--visible {
            display: block;
        }

        /*.rx-validation-error--visible ~ .rx-validation-error--visible {*/
            /*display: none;*/
        /*}*/
    </style>
</head>

<body>
<div>
    <rx-form-field>
        <label>
            Телефон

            <input is="rx-text-input"
                name="phone"
                required
                pattern="\+7 \([1-9]\d{2}\) \d{3}-\d{2}-\d{2}"
                mask="['+', '7', ' ', '(', '/[1-9]/', '/\d/', '/\d/', ')', ' ', '/\d/', '/\d/', '/\d/', '-', '/\d/', '/\d/', '-', '/\d/', '/\d/']"
                value="+7 (914) 419-17-09"
            >
        </label>

        <rx-success>Телефон введен</rx-success>
        <rx-error validator="required">Заполните данное поле</rx-error>
        <rx-error validator="pattern">Введите верный номер телефона</rx-error>
    </rx-form-field>
</div>

<div>
    <rx-form-field>
        <label>
            Текст

            <textarea is="rx-textarea"
                name="text"
                      required
            >Это текст</textarea>
        </label>

        <rx-success>Текст введен</rx-success>
        <rx-error validator="required">Заполните данное поле</rx-error>
    </rx-form-field>
</div>

<div>
    <rx-form-field>
        <label>
            Дата

            <input is="rx-date-time-input"
                   name="date"
                   required
                   value="16.10.1988, 03:21"
                   format="dd.MM.yyyy, HH:mm"
                   locale="ru"
            >
        </label>

        <rx-success>Дата введена</rx-success>
        <rx-error validator="required">Заполните данное поле</rx-error>
        <rx-error validator="format">Введите верную дату</rx-error>
    </rx-form-field>
</div>

<div>
    <rx-form-field>
        <label>
            Чекбокс

            <input is="rx-checkbox-input"
                   type="checkbox"
                   name="checkbox"
                   required
            >
        </label>

        <rx-success>Чекбокс выбран</rx-success>
        <rx-error validator="required">Выберите чекбокс</rx-error>
    </rx-form-field>
</div>

<div>
    <rx-form-field>
        <label>
            Селект

            <select is="rx-select"
                   name="select"
                   required
            >
                <option value> -- Выберите опцию -- </option>
                <option value="option-1">Опция 1</option>
                <option value="option-2">Опция 2</option>
            </select>
        </label>

        <rx-success>Селект выбран</rx-success>
        <rx-error validator="required">Выберите селект</rx-error>
    </rx-form-field>
</div>

<div>
    <rx-form-field>
        <label>
            Мультипл Селект

            <select is="rx-select-multiple"
                    name="select-multiple[]"
                    multiple
                    required
            >
                <option value="option-1">Опция 1</option>
                <option value="option-2">Опция 2</option>
                <option value="option-3">Опция 3</option>
                <option value="option-4">Опция 4</option>
            </select>
        </label>

        <rx-success>Селект выбран</rx-success>
        <rx-error validator="required">Выберите селект</rx-error>
    </rx-form-field>
</div>


<div>
    Радио
    <rx-form-field>
        <label>
            <input is="rx-radio-input" type="radio" name="radio" value="value-1" required>

            Радио 1
        </label>

        <label>
            <input is="rx-radio-input" type="radio" name="radio" value="value-2" readonly>

            Радио 2
        </label>

        <rx-success>Радио выбран</rx-success>
        <rx-error validator="required">Выберите радио</rx-error>
    </rx-form-field>
</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://npmcdn.com/flatpickr/dist/l10n/ru.js"></script>
<script src="https://cdn.jsdelivr.net/npm/luxon/build/global/luxon.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/air-datepicker/dist/js/datepicker.min.js"></script>
<script src="./dist/rx-forms.cjs.js.js"></script>
<script>
    document.querySelector('input[name="phone"]').rxValue.subscribe(v => console.log(`Phone value: ${v}`));
    document.querySelector('input[name="phone"]').rxValid.subscribe(v => console.log(`Phone valid: ${v}`));

    document.querySelector('textarea[name="text"]').rxValue.subscribe(v => console.log(`Text value: ${v}`));
    document.querySelector('textarea[name="text"]').rxValid.subscribe(v => console.log(`Text valid: ${v}`));

    document.querySelector('input[name="date"]').rxValue.subscribe(v => console.log(`Date value: ${v}`));
    document.querySelector('input[name="date"]').rxValid.subscribe(v => console.log(`Date valid: ${v}`));
    const dateInput = document.querySelector('input[name="date"]');
    // flatpickr(dateInput, {
    //   enableTime: true,
    //   dateFormat: 'd.m.Y, H:i',
    //   time_24hr: true,
    //   locale: 'ru',
    // });
    $(dateInput).datepicker({
      timepicker: true,
      dateFormat: 'dd.mm.yyyy',
      dateTimeSeparator: ', ',
      timeFormat: 'hh:ii',
      onSelect: (_, date) => {
        const dateTime = date ? luxon.DateTime.fromJSDate(date) : null;
        dateInput.setValue(dateTime);
      }
    });

    document.querySelector('input[name="checkbox"]').rxValue.subscribe(v => console.log(`Checkbox value: ${v}`));
    document.querySelector('input[name="checkbox"]').rxValid.subscribe(v => console.log(`Checkbox valid: ${v}`));

    document.querySelector('select[name="select"]').rxValue.subscribe(v => console.log(`Select value: ${v}`));
    document.querySelector('select[name="select"]').rxValid.subscribe(v => console.log(`Select valid: ${v}`));

    document.querySelector('select[name="select-multiple[]"]').rxValue.subscribe(v => console.log(`Multiple select value: ${v}`));
    document.querySelector('select[name="select-multiple[]"]').rxValid.subscribe(v => console.log(`Multiple select valid: ${v}`));

    document.querySelector('input[name="radio"]').rxValue.subscribe(v => console.log(`Radio value: ${v}`));
    document.querySelector('input[name="radio"]').rxValid.subscribe(v => console.log(`Radio valid: ${v}`));
</script>
</body>
</html>
