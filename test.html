<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/air-datepicker/dist/css/datepicker.min.css">
    <style>
        .rx-input-text--touched.rx-input-text--invalid {
            border-color: red;
        }

        .rx-input-text--touched.rx-input-text--valid {
            border-color: green;
        }

        .rx-textarea--touched.rx-textarea--invalid {
            border-color: red;
        }

        .rx-success--hidden {
            display: none;
        }

        .rx-success--visible {
            display: block;
        }

        .rx-error--hidden {
            display: none;
        }

        .rx-error--visible {
            display: block;
        }

        .rx-error--visible ~ .rx-error--visible {
            display: none;
        }
    </style>
</head>

<body>
<form is="rx-form" novalidate>
    <div>
        <rx-form-field>
            <label>
                Телефон

                <input is="rx-input-text"
                       name="phone"
                       required
                       pattern="\+7 \([1-9]\d{2}\) \d{3}-\d{2}-\d{2}"
                       mask="['+', '7', ' ', '(', '/[1-9]/', '/\d/', '/\d/', ')', ' ', '/\d/', '/\d/', '/\d/', '-', '/\d/', '/\d/', '-', '/\d/', '/\d/']"
                       value="+7 (914) 419-17-0"
                >
            </label>

            <rx-success>Телефон введен</rx-success>
            <rx-error validator="required">Заполните данное поле</rx-error>
            <rx-error validator="pattern">Введите верный номер телефона</rx-error>
        </rx-form-field>
    </div>

    <div>
        <rx-form-field>
            <label>
                Текст

                <textarea is="rx-textarea"
                          name="text"
                          required
                          minlength="12"
                          maxlength="16"
                >Это текст больш</textarea>
            </label>

            <rx-success>Текст введен</rx-success>
            <rx-error validator="required">Заполните данное поле</rx-error>
            <rx-error validator="minlength">Поле должно в длину больше 12 символов</rx-error>
            <rx-error validator="maxlength">Поле должно в длину меньше 16 символов</rx-error>
        </rx-form-field>
    </div>

    <div>
        <rx-form-field>
            <label>
                Дата

                <input is="rx-input-date-time"
                       name="date"
                       required
                       value="16/10/1988, 03:21"
                       format="dd/MM/yyyy, HH:mm"
                       locale="ru"
                       min="15/10/1988, 00:00"
                       max="17/10/1988, 00:00"
                >
            </label>

            <rx-success>Дата введена</rx-success>
            <rx-error validator="required">Заполните данное поле</rx-error>
            <rx-error validator="format">Введите верную дату</rx-error>
            <rx-error validator="min">Введите большую дату</rx-error>
            <rx-error validator="max">Введите меньшую дату</rx-error>
        </rx-form-field>
    </div>

    <div>
        <rx-form-field>
            <label>
                Число

                <input is="rx-input-number"
                       name="number"
                       required
                       value="2"
                       min="-2.1"
                       max="3.2"
                >
            </label>

            <rx-success>Число введено</rx-success>
            <rx-error validator="required">Заполните данное поле</rx-error>
            <rx-error validator="format">Введите верное число</rx-error>
            <rx-error validator="min">Введите большее число</rx-error>
            <rx-error validator="max">Введите меньшее число</rx-error>
        </rx-form-field>
    </div>

    <div>
        <rx-form-field>
            <label>
                Число

                <input is="rx-input-range"
                       type="range"
                       name="range"
                       required
                       min="-20"
                       max="20"
                >
            </label>

            <rx-success>Число введено</rx-success>
            <rx-error validator="required">Заполните данное поле</rx-error>
            <rx-error validator="format">Введите верное число</rx-error>
            <rx-error validator="min">Введите большее число</rx-error>
            <rx-error validator="max">Введите меньшее число</rx-error>
        </rx-form-field>
    </div>

    <div>
        <rx-form-field>
            <label>
                Чекбокс

                <input is="rx-input-checkbox"
                       type="checkbox"
                       name="checkbox"
                       checked
                       required
                >
            </label>

            <rx-success>Чекбокс выбран</rx-success>
            <rx-error validator="required">Выберите чекбокс</rx-error>
        </rx-form-field>
    </div>

    <div>
        <rx-form-field>
            <label>
                Селект

                <select is="rx-select"
                        name="select"
                        required
                >
                    <option value> -- Выберите опцию -- </option>
                    <option value="option-1" selected>Опция 1</option>
                    <option value="option-2">Опция 2</option>
                </select>
            </label>

            <rx-success>Селект выбран</rx-success>
            <rx-error validator="required">Выберите селект</rx-error>
        </rx-form-field>
    </div>

    <div>
        <rx-form-field>
            <label>
                Мультипл Селект

                <select is="rx-select-multiple"
                        name="select-multiple[]"
                        multiple
                        required
                >
                    <option value="option-1">Опция 1</option>
                    <option value="option-2" selected>Опция 2</option>
                    <option value="option-3" selected>Опция 3</option>
                    <option value="option-4">Опция 4</option>
                </select>
            </label>

            <rx-success>Селект выбран</rx-success>
            <rx-error validator="required">Выберите селект</rx-error>
        </rx-form-field>
    </div>

    <div>
        Радио
        <rx-form-field>
            <label>
                <input is="rx-input-radio" type="radio" name="radio" value="value-1" required checked>

                Радио 1
            </label>

            <label>
                <input is="rx-input-radio" type="radio" name="radio" value="value-2" readonly>

                Радио 2
            </label>

            <rx-success>Радио выбран</rx-success>
            <rx-error validator="required">Выберите радио</rx-error>
        </rx-form-field>
    </div>

    <button is="rx-submit" type="button">Отправить</button>
</form>

<div>
    Радио 2
    <label>
        <input is="rx-input-radio" type="radio" name="radio-2" value="value-1" required>

        Радио 1
    </label>

    <label>
        <input is="rx-input-radio" type="radio" name="radio-2" value="value-2" readonly checked>

        Радио 2
    </label>
</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://npmcdn.com/flatpickr/dist/l10n/ru.js"></script>
<script src="https://cdn.jsdelivr.net/npm/luxon/build/global/luxon.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/air-datepicker/dist/js/datepicker.min.js"></script>
<script src="./dist/rx-forms.iife.js"></script>
<script>
    // document.querySelector('input[name="phone"]').rxValue.subscribe(v => console.log(`Phone value: ${v}`));
    // document.querySelector('input[name="phone"]').rxValid.subscribe(v => console.log(`Phone valid: ${v}`));
    // document.querySelector('input[name="phone"]').rxValidationErrors.subscribe(v => console.log(`Phone errors: ${v}`));
    //
    // document.querySelector('textarea[name="text"]').rxValue.subscribe(v => console.log(`Text value: ${v}`));
    // document.querySelector('textarea[name="text"]').rxValid.subscribe(v => console.log(`Text valid: ${v}`));
    //
    // document.querySelector('input[name="date"]').rxValue.subscribe(v => console.log(`Date value: ${v}`));
    // document.querySelector('input[name="date"]').rxValid.subscribe(v => console.log(`Date valid: ${v}`));
    const dateInput = document.querySelector('input[name="date"]');
    // flatpickr(dateInput, {
    //   enableTime: true,
    //   dateFormat: 'd.m.Y, H:i',
    //   time_24hr: true,
    //   locale: 'ru',
    // });
    $(dateInput).datepicker({
      timepicker: true,
      dateFormat: 'dd.mm.yyyy',
      dateTimeSeparator: ', ',
      timeFormat: 'hh:ii',
      onSelect: (_, date) => {
        const dateTime = date ? luxon.DateTime.fromJSDate(date) : null;
        dateInput.setValue(dateTime);
      }
    });
    //
    // document.querySelector('input[name="checkbox"]').rxValue.subscribe(v => console.log(`Checkbox value: ${v}`));
    // document.querySelector('input[name="checkbox"]').rxValid.subscribe(v => console.log(`Checkbox valid: ${v}`));
    //
    // document.querySelector('select[name="select"]').rxValue.subscribe(v => console.log(`Select value: ${v}`));
    // document.querySelector('select[name="select"]').rxValid.subscribe(v => console.log(`Select valid: ${v}`));
    //
    // document.querySelector('select[name="select-multiple[]"]').rxValue.subscribe(v => console.log(`Multiple select value: ${v}`));
    // document.querySelector('select[name="select-multiple[]"]').rxValid.subscribe(v => console.log(`Multiple select valid: ${v}`));
    //
    // document.querySelector('input[name="radio"]').rxValue.subscribe(v => console.log(`Radio value: ${v}`));
    // document.querySelector('input[name="radio"]').rxValid.subscribe(v => console.log(`Radio valid: ${v}`));
    //
    // document.querySelector('input[name="radio-2"]').rxValue.subscribe(v => console.log(`Radio-2 value: ${v}`));
    // document.querySelector('input[name="radio-2"]').rxValid.subscribe(v => console.log(`Radio-2 valid: ${v}`));
    //
    // document.querySelector('input[name="number"]').rxValue.subscribe(v => console.log(`Number value: ${v}`));
    // document.querySelector('input[name="number"]').rxValid.subscribe(v => console.log(`Number valid: ${v}`));
    //
    // document.querySelector('input[name="range"]').rxValue.subscribe(v => console.log(`Range value: ${v}`));
    // document.querySelector('input[name="range"]').rxValid.subscribe(v => console.log(`Range valid: ${v}`));

    document.querySelector('form').rxValue.subscribe(v => console.log(`FORM value:`, v));
    document.querySelector('form').rxValid.subscribe(v => console.log(`FORM valid: ${v}`));
    document.querySelector('form').rxValidationErrors.subscribe(v => console.log(`FORM errors:`, v));
    document.querySelector('form').rxSubmit.subscribe(v => console.log(`FORM submit:`, v));
</script>
</body>
</html>
